<!DOCTYPE html>
<html>
<head>
  <title>Password Protection</title>
  <script type="text/javascript">
    var apiKeys = ["f55bc051f2msh236fb47b098e612p16087cjsn5d197e666ca0", "5d4bc41001msh8061d58e712e8ffp1520edjsn72515b36a183", "fddac2cc2emsh54d66c3425a468cp14354bjsn9753fb99c348"];

    function checkPassword() {
      var password = prompt("Please enter the password:");
      if (apiKeys.includes(password)) {
        sessionStorage.setItem("authenticated", "true");
        sessionStorage.setItem("expirationTime", new Date().getTime() + 60000);
        window.location.href = "authentication.html";
      } else {
        alert("Incorrect password. Please try again.");
      }
    }

    var isAuthenticated = sessionStorage.getItem("authenticated");
    var expirationTime = sessionStorage.getItem("expirationTime");

    if (!isAuthenticated || expirationTime < new Date().getTime()) {
      if (!sessionStorage.getItem("redirected")) {
        sessionStorage.setItem("redirected", "true");
        sessionStorage.removeItem("authenticated");
        sessionStorage.removeItem("expirationTime");
        window.location.href = "index.html";
      }
    }

    function submitForm(event) {
      event.preventDefault();
      var email = document.getElementById("email").value;
      var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      
      if (email.trim() !== "" && emailRegex.test(email)) {
        alert("Form submitted successfully!");
        // You can perform additional actions here, such as sending the form data to a backend server.
      } else {
        alert("Please enter a valid email.");
      }
    }

    window.onload = function() {
      checkExpirationAndRedirect();
    };

    function checkExpirationAndRedirect() {
      var isAuthenticated = sessionStorage.getItem("authenticated");
      var expirationTime = sessionStorage.getItem("expirationTime");

      if (!isAuthenticated || expirationTime < new Date().getTime()) {
        if (!sessionStorage.getItem("redirected")) {
          sessionStorage.setItem("redirected", "true");
          sessionStorage.removeItem("authenticated");
          sessionStorage.removeItem("expirationTime");
          window.location.href = "index.html";
        }
      }
    }
  </script>
</head>
<body>
  <button onclick="checkPassword()">Enter Site</button>
  <div class="holder">
    <h3>Ask for the APIKEY here:</h3>
    <p>authentication to avoid overcharge</p>
    <form name="api" netlify netlify-honeypot="bot-field" onsubmit="submitForm(event)">
      <input id="email" name="email" type="email" placeholder="Enter Email" required>
      <button type="submit">ASK</button>
      <div style="display:none;">
        <label>Donâ€™t fill this out if you're human: <input name="bot-field"></label>
      </div>
    </form>
  </div>
</body>
</html>
